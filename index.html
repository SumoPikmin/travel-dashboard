<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Travel Dashboard</title>
  <link rel="icon" type="image/png" href="data/favicon.png" />
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div class="sidebar">
    <div class="sidebar-nav top-bar">
      <h1 class="sidebar-title">Travel Dashboard</h1>
      <div class="nav-buttons">
        <button id="homeBtn" class="nav-btn active">Home</button>
        <button id="statsBtn" class="nav-btn">Stats</button>
      </div>
    </div>

      <script>
    // Ensure states is global
    window.states = {};
  </script>

  <script src="https://unpkg.com/d3@7.8.5/dist/d3.min.js"></script>
  <script src="https://unpkg.com/topojson-client@3.1.0/dist/topojson-client.min.js"></script>
  <script src="map.js"></script>
  <script src="stats.js"></script>

    <!-- Home content -->
    <div id="homeContent">
      <hr />
      <div id="mapView">
        <h2>Travel Map</h2>
        <p>Mark countries as <strong>neutral</strong>, <strong>been</strong> or <strong>want to go</strong>. Click countries on the map to cycle the status or use the search box below.</p>

        <div class="search">
          <input id="searchInput" type="text" placeholder="Search country (e.g. Spain)" autocomplete="off" />
          <ul id="suggestions"></ul>
          <select id="statusSelect">
            <option value="neutral">Neutral</option>
            <option value="been">Been</option>
            <option value="want">Want to go</option>
          </select>
          <button id="applyBtn">Enter</button>

          <ul id="suggestions" style="
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #ccc;
            max-height: 150px;
            overflow-y: auto;
            list-style: none;
            margin: 0;
            padding: 0;
            z-index: 1000;
            display: none;
          "></ul>
        </div>

        <div class="legend">
          <div class="item"><div class="swatch" style="background: #ffffff"></div> Neutral</div>
          <div class="item"><div class="swatch" style="background: #8ecae6"></div> Been</div>
          <div class="item"><div class="swatch" style="background: #ffd166"></div> Want to go</div>
        </div>

        <div class="note">Progress is not saved automatically â€” click the button below to save and load the progress.</div>

        <div class="controls">
          <button id="resetBtn">Reset</button>
          <button id="importBtn">Load Progress</button>
          <button id="exportBtn">Save Progress</button>
          <input id="fileInput" type="file" accept="application/json" style="display:none" />
        </div>

        <hr />
        <strong>Quick actions</strong>
        <ul>
          <li>Hover over countries to see their name.</li>
          <li>Click on countries to change their status. (
            <span style="color: black;">Neutral</span> &rarr; 
            <span style="color: #8ecae6;">Been</span> &rarr; 
            <span style="color: #ffd166;">Want</span> &rarr; 
            <span style="color: black;">Neutral</span>)</li>
        </ul>
      </div>
    </div>

    
    <!-- Stats content -->
    <div id="statsContent" style="padding: 0 10px;">
      <h2>Statistics</h2>
      <p id="statsSummary">Loading stats...</p>
      <p>This section will display your travel statistics and charts.</p>
      <svg width="120" height="120">
      <!-- Background circle -->
      <circle
        stroke="#4caf50"
        stroke-width="10"
        fill="none"
        r="54"
        cx="60"
        cy="60"
        opacity="0.2"
      ></circle>

      <!-- Progress circle -->
      <circle
        class="progress-bar"
        stroke="#4caf50"
        stroke-width="10"
        fill="none"
        r="54"
        cx="60"
        cy="60"
        stroke-linecap="round"
        style="transform: rotate(-90deg); transform-origin: 50% 50%;"
      ></circle>

      <!-- Percentage text -->
      <text id="progressText" x="60" y="65" text-anchor="middle" font-size="24" fill="#4caf50"></text>
    </svg>

  </div>
</div>

  <div class="map-wrap">
    <div id="tooltip" class="tooltip"></div>
    <svg id="map"></svg>
    <div class="footer">Tip: use zoom (mouse wheel) and drag to pan</div>
  </div>
  

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const countries = [
        // ... same country list as before ...
        "Afghanistan", "Albania", "Algeria", "Andorra", "Angola", "Antigua and Barbuda", "Argentina", "Armenia", "Australia", "Austria",
        "Azerbaijan", "Bahamas", "Bahrain", "Bangladesh", "Barbados", "Belarus", "Belgium", "Belize", "Benin", "Bhutan",
        "Bolivia", "Bosnia and Herzegovina", "Botswana", "Brazil", "Brunei", "Bulgaria", "Burkina Faso", "Burundi", "Cabo Verde", "Cambodia",
        "Cameroon", "Canada", "Central African Republic", "Chad", "Chile", "China", "Colombia", "Comoros", "Congo", "Democratic Republic of Congo",
        "Costa Rica", "Cote d'Ivoire", "Croatia", "Cuba", "Cyprus", "Czech Republic", "Denmark", "Djibouti", "Dominica", "Dominican Republic",
        "Ecuador", "Egypt", "El Salvador", "Equatorial Guinea", "Eritrea", "Estonia", "Eswatini", "Ethiopia", "Fiji", "Finland",
        "France", "Gabon", "Gambia", "Georgia", "Germany", "Ghana", "Greece", "Grenada", "Guatemala", "Guinea",
        "Guinea-Bissau", "Guyana", "Haiti", "Honduras", "Hungary", "Iceland", "India", "Indonesia", "Iran", "Iraq",
        "Ireland", "Israel", "Italy", "Jamaica", "Japan", "Jordan", "Kazakhstan", "Kenya", "Kiribati", "North Korea",
        "South Korea", "Kosovo", "Kuwait", "Kyrgyzstan", "Laos", "Latvia", "Lebanon", "Lesotho", "Liberia", "Libya",
        "Liechtenstein", "Lithuania", "Luxembourg", "Madagascar", "Malawi", "Malaysia", "Maldives", "Mali", "Malta", "Marshall Islands",
        "Mauritania", "Mauritius", "Mexico", "Micronesia", "Moldova", "Monaco", "Mongolia", "Montenegro", "Morocco", "Mozambique",
        "Myanmar", "Namibia", "Nauru", "Nepal", "Netherlands", "New Zealand", "Nicaragua", "Niger", "Nigeria", "North Macedonia",
        "Norway", "Oman", "Pakistan", "Palau", "Palestine", "Panama", "Papua New Guinea", "Paraguay", "Peru", "Philippines",
        "Poland", "Portugal", "Qatar", "Romania", "Russia", "Rwanda", "Saint Kitts and Nevis", "Saint Lucia", "Saint Vincent and the Grenadines", "Samoa",
        "San Marino", "Sao Tome and Principe", "Saudi Arabia", "Senegal", "Serbia", "Seychelles", "Sierra Leone", "Singapore", "Slovakia", "Slovenia",
        "Solomon Islands", "Somalia", "South Africa", "South Sudan", "Spain", "Sri Lanka", "Sudan", "Suriname", "Sweden", "Switzerland",
        "Syria", "Taiwan", "Tajikistan", "Tanzania", "Thailand", "Timor-Leste", "Togo", "Tonga", "Trinidad and Tobago", "Tunisia",
        "Turkey", "Turkmenistan", "Tuvalu", "Uganda", "Ukraine", "United Arab Emirates", "United Kingdom", "United States of America", "Uruguay", "Uzbekistan",
        "Vanuatu", "Vatican City", "Venezuela", "Vietnam", "Yemen", "Zambia", "Zimbabwe"
      ];

      // Show / hide tabs
      const homeBtn = document.getElementById('homeBtn');
      const statsBtn = document.getElementById('statsBtn');
      const homeContent = document.getElementById('homeContent');
      const statsContent = document.getElementById('statsContent');

      function showTab(tabId) {
        if (tabId === 'homeContent') {
          homeContent.style.display = 'block';
          statsContent.style.display = 'none';
          homeBtn.classList.add('active');
          statsBtn.classList.remove('active');
        } else if (tabId === 'statsContent') {
          homeContent.style.display = 'none';
          statsContent.style.display = 'block';
          homeBtn.classList.remove('active');
          statsBtn.classList.add('active');

          if (window.updateStats) {
            setTimeout(window.updateStats, 0); // ensures DOM updates first
          }
        }
      }


      homeBtn.addEventListener('click', () => showTab('homeContent'));
      statsBtn.addEventListener('click', () => showTab('statsContent'));

      // Start on Home tab by default
      showTab('homeContent');
    });
  </script>
</body>
</html>
